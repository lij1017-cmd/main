Asset Class Trend Following 策略重現報告 (含停損機制參數最佳化)

策略說明 本策略使用 Asset Class Trend Following 方法，參考：https://quantpedia.com/strategies/asset-class-trend-following。針對 131 檔商品進行回測，並加入停損機制以提升風險控制。所有核心參數皆需進行最佳化，以最大化 Calmar Ratio及CAGR。
資料來源: 個股1.xls

初始資金: 3,000 萬元。每次投資組合均投入固定的初始資金金額，且平均分給前3大持股

最大持股: 3 檔

再平衡週期: 每 5 個交易日

資料整理:

較晚上市標的：以首次出現的價格往前期填補

中途暫停交易標的：以前一日收盤價填補中間空白區域

進場邏輯:

價格高於 SMA 且 ROC 為正

選取 ROC 前 3 名標的

交易執行:

T 日產生訊號，T+1 日以收盤價執行

持倉管理:

若原有持股仍位列前 3 名，則「保持原股數續抱」

僅賣出跌出排名的標的，並新增新的標的

停損機制 (二擇一)
本策略僅採用 單一停損方式，並透過螞蟻演算法進行參數最佳化：

最高價回落停損 (Peak-to-Trough Stop)

當收盤價相對持有期間最高收盤價跌幅超過 StopLoss% 時觸發停損。

或

移動平均線停損 (MA Stop)

當收盤價跌破短期均線 MA_stop 時觸發停損。

在回測過程中，僅選用其中一種停損方式，並針對該停損參數進行最佳化。

參數最佳化 本策略使用螞蟻演算法，需同時最佳化以下兩個核心參數，+一個停損參數(二擇一)，目標為 Calmar Ratio及CAGR 最大化：
SMA (簡單移動平均線長度)

ROC (變動率計算期間)

停損參數:僅選用一種停損方式:最高價回落停損比率 (StopLoss%)或

移動平均停損週期 (MA_stop)

最佳化方法：

使用 螞蟻搜尋法  ，在指定範圍內搜尋最佳組合。由於此策略篇較短線交易，回測最佳化期間以不超過180天為上限。

評估指標：Calmar Ratio、CAGR、MaxDD、Win Rate。

策略績效目標 Calmar Ratio > 5
最大回撤 (MDD) < 18%

參數高原表 (示例：SMA vs Calmar, ROC=100) SMA CAGR MaxDD Calmar 10 118.07% -45.23% 2.61 20 120.68% -46.31% 2.61 30 132.30% -41.67% 3.18 40 123.48% -45.55% 2.71 50 112.73% -45.78% 2.46 60 119.68% -45.37% 2.64 80 123.47% -53.72% 2.30 100 147.13% -54.63% 2.69 120 126.28% -46.53% 2.71 150 128.95% -48.05% 2.68 200 137.18% -47.88% 2.87 註：最終報告需同時呈現四維度參數最佳化的「高原表」，以便觀察不同組合下的 Calmar Ratio 變化。

檔案清單與產出 trendstrategy_equity2024.ipynb

包含完整資料清理、停損機制與參數最佳化回測程式碼

所有參數集中於同一區域，方便快速修正。並用繁體中文詳細說明之。

產出交易明細:trendstrategy_results_equity2024.xlsx

Trades：詳細交易明細 (含買進日期、標的名稱、價格、股數、每周平衡時保留與上一期相同之商品、賣出剃除商品、買進新持有商品、價格、股數、每期報酬表現)，包含每檔商品的最佳參數。買進參數詳細內容 (可多欄)原因。最後一欄：繁體中文說明選取出的資產及其相對動能值)

Equity_Curve：每日權益變化數據及權益曲線圖 (含回撤陰影)

Equity_Hold：每期持股檔數與明細

Summary：策略績效總結 (CAGR, MaxDD, Calmar, Win Rate, 最佳參數等)

reproduce_report2024.md

本策略說明文件，繁體中文撰寫，嚴謹清晰
