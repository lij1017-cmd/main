雙動能交易策略 — 回測專案說明
策略目標
Calmar Ratio > 5

最大回撤 (MDD) < 18%

年化報酬率 > 100%

資金配置
初始資金：新台幣 1000 萬元

每次單筆投入：1000 萬元

平均分配至 最強動能前 2 檔商品

資料來源
檔案：16ETF-V1.xls

內容：16 種商品的日還原收盤價

特性
商品起始時間不一致

回測時，隨著新商品逐步加入，擴大樣本群

範例：

2017/5/2 → 9 檔商品

2017/9/27 → 10 檔商品

2017/11/16 → 12 檔商品

2018/10/3 → 13 檔商品

策略流程
1. 計算動能
策略參數最佳化方法：螞蟻演算法

最終策略必須以 Calmar Ratio 最高 為唯一目標。

採用 逐標的最佳化 (Per-Asset Optimization)：

每個商品各自測試多組候選參數 (兩個不同周期平均、三個不同周期平均)。

限制條件：所有周期參數值不得大於 80

例：兩個平均 → (5, 50) 或 (48, 70)，皆可接受

三個平均 → (3, 11, 50) 或 (9, 60, 80)，皆可接受

但若任何一個參數 > 80，則不納入測試

為每個商品找出「自己最佳化後的參數組合」。

在每次再平衡時：

使用各商品的最佳化分數

排序挑選前 2 檔

平均分配單筆投入資金

2. 篩選標的
選取 報酬率為正值 的前 2 檔商品

作為投資組合配置

3. 交易規則
每 5 天重新配置一次

T 日產生訊號，T+1 日收盤價進場買賣，以 T+1 日收盤價計算持有期間報酬率

策略再平衡與持股規則
1. 新一期持股判斷
若新一期篩選出的商品與上一期相同，則 保留原有持股數

不重新依照新一期股價計算股數

目的：確保損益計算正確，避免因股數變動而影響報酬率

2. 新增標的
若新一期篩選出的商品為新標的，則依照資金配置原則以 T+1 日收盤價計算股數進場交易

3. 移除標的
若上一期持有商品未被新一期選中，則在 T+1 日收盤價全數賣出，並計算損益

4. 損益計算原則
保留標的：沿用前一期股數，依新一期收盤價計算市值

新增標的：依資金配置原則計算股數

移除標的：依賣出價與原持股數計算損益

程式設計需求
所有程式碼放在同一個 ipynb 檔案

所有參數集中在同一區域，方便後續修改

必須有結構嚴謹、詳細繁體中文註解

輸出結果
1. Excel 檔案：dualstrategy_results2022.xlsx
Trades：交易明細 (含買進日期、標的名稱、價格、股數、每周平衡時保留倉與上一期相同之商品、賣出剃除商品、買進新持有商品、價格、股數、每期報酬表現)，包含每檔商品的最佳參數。最後一欄：繁體中文說明選取出的資產及其相對動能值

Equity_Curve：每期權益變化數據、權益曲線圖 (含回撤陰影)

Equity_Hold：每期持股檔數與明細

Summary：包含 CAGR、MaxDD、Calmar Ratio、勝率 (Win Rate)、最佳參數、每年度年化報酬率

2. Markdown 文件 (繁體中文)
嚴謹清晰

詳細計算步驟

可讓 AI 或研究者完整重現程式與結果

3. 參數高原表
將所有最佳化的參數值整理成表格

顯示不同週期組合下的績效表現

範例表格：

參數組合	CAGR	MaxDD	Calmar	勝率	備註
(5, 50)	xx%	xx%	xx	xx%	短中期動能組合
(9, 60, 80)	xx%	xx%	xx	xx%	三期動能組合
